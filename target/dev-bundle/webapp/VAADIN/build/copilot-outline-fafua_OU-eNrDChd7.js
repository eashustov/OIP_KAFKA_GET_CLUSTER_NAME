import{_ as d,f as p,u,n as v,X as o,U as m,p as f,l as b,c as x,F as c,d as y,e as C,h as k,j as w,O as I,k as $,T as A,g as P}from"./indexhtml-5JtH9nlG.js";import{o as D}from"./base-panel-ZMfG2SWA-ylp3jc5Q.js";const O="copilot-outline-panel{padding:0;position:relative;height:var(--default-content-height)}copilot-outline-panel vaadin-grid{background-color:transparent;--vaadin-grid-cell-background: transparent;--vaadin-grid-cell-padding: var(--space-100) var(--space-150);font:inherit;color:inherit}copilot-outline-panel vaadin-grid::part(cell){cursor:default;min-height:auto}copilot-outline-panel vaadin-grid::part(row):hover{outline:1px solid var(--selection-color);outline-offset:-1px}copilot-outline-panel vaadin-grid::part(selected-row){background:var(--blue-100);color:var(--color-high-contrast)}copilot-outline-panel vaadin-grid::part(selected-row):hover{outline:0}copilot-outline-panel vaadin-grid::part(cell):focus-visible,copilot-outline-panel vaadin-grid::part(row):focus-visible{outline:2px solid var(--blue-300);outline-offset:-2px}copilot-outline-panel vaadin-grid-tree-toggle::part(toggle){color:var(--border-color-high-contrast);opacity:0}copilot-outline-panel:hover vaadin-grid-tree-toggle::part(toggle){opacity:1}";var T=Object.defineProperty,K=Object.getOwnPropertyDescriptor,h=(e,t,i,a)=>{for(var n=a>1?void 0:a?K(t,i):t,r=e.length-1,l;r>=0;r--)(l=e[r])&&(n=(a?l(t,i,n):l(n))||n);return a&&n&&T(t,i,n),n};function g(e){if(e.currentTarget)return e.currentTarget.getEventContext(e).item}let s=class extends D{constructor(){super(...arguments),this.expandedItems=[],this.initialExpandDone=!1,this.filter=e=>d(e)?!0:!!p(e),this.getFilteredChildren=e=>{const t=u(e);if(t.length===0)return[];const i=t.filter(this.filter);return i.length===t.length?t:t.flatMap(a=>i.includes(a)?a:this.getFilteredChildren(a))},this.dataProvider=(e,t)=>{if(!this.reactApp)t([],0);else if(!e.parentItem)t([this.reactApp],1);else{const i=this.getFilteredChildren(e.parentItem);t(i,i.length)}}}connectedCallback(){super.connectedCallback(),this.componentTreeUpdated(),this.onEventBus("component-tree-updated",()=>this.componentTreeUpdated())}render(){return v`
      <style>
        ${O}
      </style>
      <vaadin-grid
        all-rows-visible
        .dataProvider=${this.dataProvider}
        .selectedItems=${o.getSelections.map(e=>m(e.element))}
        @keydown=${this.gridKeyDown}
        @mousemove=${this.gridItemMouseMove}
        @click=${this.gridItemClick}
        theme="no-border no-row-borders">
        <vaadin-grid-tree-column
          auto-width
          .__getToggleContent=${this.renderToggleColumn}
          .__isLeafItem=${this.isLeafItem.bind(this)}></vaadin-grid-tree-column>
      </vaadin-grid>
    `}renderToggleColumn(e,t){let i="";return p(t)?i="â™¦ ":f(t)&&(i="</> "),`${i}${b(t)}`}isLeafItem(e){return this.getFilteredChildren(e).length===0}gridKeyDown(e){e.altKey||e.metaKey||e.ctrlKey||e.shiftKey||(e.code==="Space"?(e.preventDefault(),e.stopPropagation()):(e.key==="Backspace"||e.key==="Delete")&&(x.emit("delete-selected",{}),e.preventDefault(),e.stopPropagation()))}gridItemMouseMove(e){let t;const i=g(e);i&&d(i)&&(t=c(i)),t?o.setHighlighted({element:t}):o.setHighlighted(void 0),e.preventDefault(),e.stopPropagation()}gridItemClick(e){const t=g(e);if(!t||!d(t))return;!e.metaKey&&!e.ctrlKey&&o.clearSelection();const i=c(t);i?o.isSelected(i)?o.deselect(i):o.select(i):y("Unable to find element for selection",t),C("use-outline")}updated(e){super.updated(e),this.initialExpandDone||this.expandAll()}expandAll(){this.reactApp&&this.grid&&(this.grid.expandedItems=[this.reactApp,...k(this.reactApp)],this.initialExpandDone=!0)}componentTreeUpdated(){if(this.reactApp=w(),this.grid){if(this.reactApp){const e=this.grid.expandedItems.map(t=>I(t));e.length>0&&!e.includes(this.reactApp)?this.expandAll():this.grid.expandedItems=e}this.grid.clearCache()}this.requestUpdate()}};h([$("vaadin-grid")],s.prototype,"grid",2);s=h([P("copilot-outline-panel")],s);const U={header:"Outline",expanded:!0,draggable:!0,panelOrder:0,panel:"left",floating:!1,tag:"copilot-outline-panel",showOn:[A.HillaReact]},_={init(e){e.addPanel(U)}};window.Vaadin.copilotPlugins.push(_);export{s as CopilotOutlinePanel};
